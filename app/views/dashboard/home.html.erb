<!-- <h1>Dashboard#home</h1>
<p>Find me in app/views/dashboard/home.html.erb</p> -->


 <script src="http://cdn.jsdelivr.net/npm/vue"></script>








<% user_signed_in? && current_user.email == 'austin@sequoiacpe.com' ? @name = 'Austin' : '' %>
 <div class="well well-lg">
   <h1 class="text-center"><%= @name %> Dashboard </h1>
 </div>


<!-- <div id="app">
  {{ message }}
</div>

<script>
  var app = new Vue({
    el: '#app',
    data: {
      message: "Hello world"
    }
  });
</script> -->

</br>


  <div class="col-sm-3" id="app">
    <div class="well">
    <h2 class="text-center"> Quick Notes</h2>
    <h4 class="text-center body-text"> Vue.js Local Storage </h4>
    <input class="form-control" placeholder="Add A New Simple Task" v-model="newTodo" @keydown.enter="addTodo">
</br>
    <div class="list-unstyled list-group" >
      <li v-for="todo in todos" :class="{ completed: todo.completed }" class="list-group-item">
        <input type="checkbox" v-model="todo.completed">
        <input type="text" v-if="todo === editTodo" v-auto-focus class="text-input" @keyup.enter="endEdit(todo)" @blur="endEdit(todo)" v-model="todo.text">
        <label  v-if="todo !== editTodo" @dblclick="edit(todo)">{{ todo.text }}</label>
        <button class="btn" @click="remove(todo)">X</button>
      </li>
    </div>
  </div>




<div class="well">
    <h2 class="text-center">Big Notes</h2>
    <h4 class="text-center body-text">Database Storage</h4>
    <div>
      <%= link_to 'New Note', new_note_path, class: 'btn btn-default' %>
    </div>
  </br>
  <!-- <table class=""> -->
      <!-- <tbody> -->
    <% @notes.each do |note| %>
        <!-- Trigger the modal with a button -->
    <!-- <span class="list-group"> -->

        <li class="list-group-item"><button type="button" class="btn" data-toggle="modal" data-target="#myModal"><%= note.title %></button></li>

    <!-- </span> -->
        <!-- Modal -->

        <div class="modal fade" id="myModal" role="dialog">
          <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">

                  <%= note.title %> | <%= link_to 'Edit', edit_note_path(note) %>

                </h4>
              </div>
              <div class="modal-body">
                <!-- <% note.user_id %> -->
                <% if user_signed_in? && note.user_id == current_user.id%>
                  <tr>
                      <%= note.note %>
                    <!-- <td><%= note.user_id %></td> -->
                    <!-- <td><%= link_to 'Show', note %></td> -->
                    <!-- <td><%= link_to 'Edit', edit_note_path(note) %></td> -->
                  </tr>
                <% end %>
              </div>
              <div class="modal-footer">

                  <% if note.done == false %>
                    Status: <i class="fa fa-check-circle fa-2x table-icons-green"></i>
                  <% elsif %>
                    Status: <i class="fa fa-check-circle fa-2x table-icons-green"></i>
                  <% end %>

                  <% if note.type_one == true %>
                    | Type: One
                  <% elsif note.type_two == true %>
                    | Type: Two
                  <% elsif note.type_three == true%>
                    | Type: Three
                  <% end %>

                  <!-- <%= link_to 'Remove', note, method: :delete, data: { confirm: 'Are you sure?' } %> -->

                  <% if note.due == true %>
                    | <%= note.due_date %>
                  <% elsif %>
                  <p></p>
                  <% end%>



                <button type="button" class="btn btn-default" data-dismiss="modal">
                  Close

                </button>
              </div>
            </div>

          </div>
        </div>





<% end %>
      <!-- </tbody> -->
    <!-- </table> -->
  </div>
</div>

 <div class="col-sm-6">
  <div class="well">
  <h2 class="text-center">Upcoming Schedule</h2>

  <table class="table table-hover">
    <thead>
      <tr>
        <!-- <th>Mail</th> -->
        <th><h4 class="body-text">Title</h4></th>
        <th><h4 class="body-text">MSI Date</h4></th>
        <th><h4 class="body-text">Drop Date</h4></th>
        <th><h4 class="body-text">Art</h4></th>
        <!-- <th>Quantity</th>
        <th>Data File</th>
        <th>Art File</th> -->
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @mail_items.each do |mail_item| %>
        <tr>
          <!-- <td><%= mail_item.mailSchedule.mail_id %></td> -->
          <td><%= mail_item.title %></td>
          <td><%= (mail_item.mailSchedule.drop_date - 10).strftime('%m/%d/%y') %></td>
          <td><%= mail_item.mailSchedule.drop_date.strftime('%m/%d/%y') %></td>
          <% if mail_item.complete == true %>
            <td><i class="fa fa-check-circle fa-2x table-icons-green"></i></td>
          <% elsif %>
            <td><i class="fa fa-times-circle fa-2x table-icons-red"></i></td>
          <% end %>

          <!-- <td><%= mail_item.quantity %></td>

          <td><%= mail_item.mail_id.to_f / 10 %>.xlsx</td>
          <td><%= mail_item.mail_id.to_f / 10 %>.pdf</td> -->

          <td><%= link_to 'Materials', mail_item, class: 'btn btn-default' %></td>

          <!-- <td><%= link_to 'Edit', edit_mail_item_path(mail_item) %></td>
          <td><%= link_to 'Destroy', mail_item, method: :delete, data: { confirm: 'Are you sure?' } %></td> -->
        </tr>
      <% end %>
    </tbody>
  </table>




</div>
</div>

<div class="col-sm-3">
  <div class="well">
    <h2 class="text-center">Sales</h2>

    <form id="search">
      <input type="search" id="symbols" value="" placeholder="AUD, USD">
      <button id="results1">Go</button>
    </form>

    <div id="results1">

    </div>
  </div>

  <div class="well">
    <h2 class="text-center">Courses</h2>

    <!-- <% @day = Exam.group(:des, :seq_number).order(:des, :seq_number).count %>

    <% @day.each do | k , v | %>
      <div><%#= e.join(":  ") %></div>
      <div><%= k.join( " - ") %> taken <%= v %> times</div>

    <%end%> -->
    <h4 class="body-text text-center">Date Params: </h4>
    <%= bar_chart Exam.group(:seq_number).count %>

  </div>
</div>


<script>

var todo = new Vue({
  el: '#app',
  data: {
    newTodo: '',
    todos: [],
    editTodo: {}
  },
  methods: {
    addTodo() {
      this.todos.push({ text: this.newTodo, completed: false });
      this.newTodo = '';
    },
    remove(todo) {
      console.log('removed');
      let index = this.todos.indexOf(todo)
      this.todos.splice(index, 1)
      localStorage.setItem('todos', JSON.stringify(this.todos));
    },
    edit(todo) {
      console.log('edit');
      this.editTodo = todo;
    },

    endEdit(todo) {
      console.log('editEnd');
      this.editTodo = {};
      if (todo.text.trim() === ""){
        this.remove(todo);
      }
    },

  },
  mounted() {
    console.log('mounted');
    if (localStorage.getItem('todos')) this.todos = JSON.parse(localStorage.getItem('todos'));
  },
  watch: {
    todos: {
      handler() {
        console.log('changed');
        localStorage.setItem('todos', JSON.stringify(this.todos));
      },
      deep: true,
    },
  },
});

</script>
